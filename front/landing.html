<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>로딩 중...</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5 text-center">
        <h1>제보를 처리 중입니다...</h1>
        <div class="spinner-border text-primary" role="status">
            <span class="sr-only">Loading...</span>
        </div>
        <p class="mt-3">잠시만 기다려 주세요.</p>
    </div>

    <script>
        // 이 페이지에서는 실제로 데이터 전송을 처리합니다.
        function sendData() {
            const form = localStorage.getItem('formData');
            if (form) {
                const formData = new FormData();
                form.split('&').forEach(pair => {
                    const [key, value] = pair.split('=');
                    formData.append(decodeURIComponent(key), decodeURIComponent(value));
                });

                fetch('/submit-report', {
                    method: 'POST',
                    body: formData
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        window.location.href = '/success'; // 성공 시 이동할 페이지
                    } else {
                        window.location.href = '/failure'; // 실패 시 이동할 페이지
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    window.location.href = '/failure'; // 실패 시 이동할 페이지
                });
            }
        }

        // 로딩 페이지에서 데이터 전송을 시작합니다.
        window.onload = sendData;
    </script>
</body>
</html>
